Como miembros del CSIRT, la investigación del incidente en la máquina del departamento de IT comienza con la fase crítica de Recolección y Contención, aplicando una metodología estricta para preservar la cadena de custodia e integridad de la evidencia.Metodología Aplicada: Respuesta a Incidentes (DFIR)FaseBreves NotasPreparaciónVerificación de las herramientas forenses (triage scripts, WinPMEM, FTK Imager) y los medios de almacenamiento seguros. Establecimiento de la hora UTC de referencia.Identificación/ContenciónAislamiento lógico de la máquina comprometida (manteniendo la alimentación) y obtención de credenciales para el triage live.Recolección (Adquisición)Adquisición de la evidencia según el orden de volatilidad: RAM $\rightarrow$ Triage live $\rightarrow$ Disco duro.AnálisisUso de herramientas forenses (Volatile, KAPE, Autopsy) en la máquina forense para examinar la evidencia recolectada. (Corresponde al Punto 2).Erradicación/RecuperaciónAcciones post-análisis: Eliminación del malware, parcheado de vulnerabilidades y restablecimiento del servicio.Recolección de Evidencias: Pasos DetalladosLa recolección se realiza priorizando la información más volátil (RAM y estado del sistema) antes de la adquisición de la memoria no volátil (disco duro).1. Evidencia Volátil (Live Triage y RAM)PasoDescripción DetalladaA. Adquisición de la RAMSe utiliza WinPMEM.exe para realizar un dump completo de la memoria volátil a un directorio local temporal, minimizando la escritura en el disco. C:\Forense_Caso01\02_memory\tools\winpmem.exe --output C:\Forense_Caso01\02_memory\EV_RAM_raw_20251117_093000.raw --format rawB. Triage del SistemaSe ejecutan los scripts de triage para capturar el estado del sistema en vivo: información de red (netstat, ipconfig), procesos (tasklist, wmic), servicios, autoruns y usuarios. Los outputs se guardan en C:\Forense_Caso01\01_triage_live\.C. Cálculo de Hash (RAM)Inmediatamente después del dump, se calcula el valor hash de la imagen de RAM para garantizar su integridad. CertUtil -hashfile C:\Forense_Caso01\02_memory\EV_RAM_raw_20251117_093000.raw SHA256 > hash_ram_sha256.txtD. Transferencia de EvidenciaLos ficheros de triage y la imagen de RAM se transfieren a la máquina forense a través de la carpeta compartida configurada para el proyecto.2. Evidencia No Volátil (Adquisición de Disco)PasoDescripción DetalladaE. Preparación del DiscoSe convierte la OVA de la máquina comprometida a formato RAW mediante QEMU Imager en el entorno de laboratorio.F. Adquisición ForenseEn la máquina forense, se monta la imagen RAW y se utiliza FTK Imager para crear una copia forense completa (bit-by-bit) del disco, asegurando que el hash del dispositivo original y el de la imagen coincidan.Justificación de OmisiónOmisión: En el escenario simulado, no se extraen físicamente los ficheros del sistema de la víctima, ni se toman fotografías del estado de la máquina (fotos de pantalla, conexiones).Razón: Este es un entorno simulado (Virtual Machine), donde la adquisición se basa en el acceso remoto y la imagen de la OVA.Caso Real: En un incidente real, los pasos omitidos son críticos. Se debe acordonar y fotografiar la escena, documentando pantallas activas, conexiones de red y el estado físico del equipo antes de su desconexión. Además, la evidencia volátil se copiaría a un dispositivo de solo lectura (ej. USB Write Blocker) para su transporte.Descripción de la Evidencia RecolectadaEvidenciaTipo de EvidenciaCaracterísticas RelevantesEV_RAM_raw...Memoria VolátilContiene el estado del sistema: procesos en ejecución, conexiones de red activas, sockets y strings sensibles. Formato RAW.01_triage_live.rarTriage LiveArchivos de texto (.txt) con la salida de comandos como netstat, tasklist, ipconfig, schtasks, etc. Ficheros que documentan el estado instantáneo del OS.EV_DISC_raw...Imagen de DiscoCopia física bit-a-bit del disco duro de la víctima. Contiene el sistema de archivos completo, registros de eventos, logs y artifacts. Formato RAW/E01.Cadena de Custodia (Inicio)EvidenciaCuándoDóndeQuiénAcción (Descubrimiento/Colección/Custodia)Hash (Ejemplo)Incidente2025-11-17, 09:00 CETDept. de IT (IP X.X.X.X)Analista Forense 1Notificación y aseguramiento de la escenaN/AEV_RAM_raw...2025-11-17, 09:30 CETMáquina ComprometidaAnalista Forense 1Recolección (WinPMEM)[Insertar Hash SHA256 de RAM]01_triage_live.rar2025-11-17, 09:45 CETMáquina ComprometidaAnalista Forense 1Recolección (Scripts de Triage)[Insertar Hash SHA256 del RAR]Custodia2025-11-17, 10:00 CETServidor ForenseAnalista Forense 2Recepción y almacenamiento seguroN/AAlmacenamiento de la EvidenciaMétodos: Las evidencias se almacenan en un Servidor Forense dedicado con control de acceso estricto. La imagen de disco (EV_DISC) se cifra en reposo. Se ha utilizado la carpeta compartida de la red aislada como medio de transferencia inicial de los datos volátiles.Ubicación: Servidor de Almacenamiento Forense, Ruta: /Proyecto/Caso_2025-11-17_IT_MACHINE/.Nota: Por favor, asegúrate de reemplazar el siguiente enlace por el de tu repositorio público con las evidencias.Enlace a las Evidencias en Repositorio Público:[Enlace a su repositorio aquí]
