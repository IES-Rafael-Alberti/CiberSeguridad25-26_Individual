¡Excelente! Has realizado la fase de recolección de evidencias de forma exhaustiva. A continuación, te presento el **Punto 1** completo con la integración de los *hashes* y la estructura completa para el **Punto 3 (Informe)**, utilizando hallazgos simulados para guiar la documentación de tu análisis.

---

# PROYECTO DE ANÁLISIS FORENSE DIGITAL

## 1. Recolección y Almacenamiento de Evidencias

Como miembros del **CSIRT**, la investigación del incidente en la máquina del departamento de IT comienza con la fase crítica de **Recolección y Contención**, aplicando una metodología estricta para preservar la **cadena de custodia** e **integridad de la evidencia**.

### Metodología Aplicada: Respuesta a Incidentes (DFIR)

Se aplica un modelo estándar de respuesta a incidentes forenses, priorizando la volatilidad de la evidencia.

| Fase | Breves Notas |
| :--- | :--- |
| **Preparación** | Verificación de las herramientas forenses (*triage* scripts, **WinPMEM**, **FTK Imager**) y los medios de almacenamiento seguros. Establecimiento de la hora UTC de referencia. |
| **Identificación/Contención** | **Aislamiento lógico** de la máquina comprometida (manteniendo la alimentación) y obtención de credenciales para el *triage live*. |
| **Recolección (Adquisición)** | Adquisición de la evidencia según el orden de volatilidad: **RAM** $\rightarrow$ **Triage *live*** $\rightarrow$ **Disco duro**. |
| **Análisis** | Uso de herramientas forenses (*Volatile, KAPE, Autopsy*) en la máquina forense para examinar la evidencia recolectada. (Corresponde al Punto 2). |
| **Erradicación/Recuperación** | Acciones post-análisis: Eliminación del *malware*, parcheado de vulnerabilidades y restablecimiento del servicio. |

***

### Recolección de Evidencias: Pasos Detallados

La recolección se realiza priorizando la información más volátil (RAM y estado del sistema) antes de la adquisición de la memoria no volátil (disco duro).

#### 1. Evidencia Volátil (*Live Triage* y RAM)

| Paso | Descripción Detallada |
| :--- | :--- |
| **A. Adquisición de la RAM** | Se utiliza **WinPMEM.exe** para realizar un *dump* completo de la memoria volátil a un directorio local temporal, minimizando la escritura en el disco. `C:\Forense_Caso01\02_memory\tools\winpmem.exe --output C:\Forense_Caso01\02_memory\EV_RAM_raw_20251117_093000.raw --format raw` |
| **B. Triage del Sistema** | Se ejecutan los *scripts* de *triage* para capturar el estado del sistema en vivo: información de red (`netstat`, `ipconfig`), procesos (`tasklist`, `wmic`), servicios, *autoruns* y usuarios. Los *outputs* se guardan en `C:\Forense_Caso01\01_triage_live\`. |
| **C. Cálculo de Hash (RAM)** | [cite_start]Inmediatamente después del *dump*, se calcula el **valor hash** de la imagen de RAM [cite: 132] para garantizar su integridad. `CertUtil -hashfile C:\Forense_Caso01\02_memory\EV_RAM_raw_20251117_093000.raw SHA256 > hash_ram_sha256.txt` |
| **D. Transferencia de Evidencia** | Los ficheros de *triage* y la imagen de RAM se transfieren a la máquina forense a través de la **carpeta compartida** configurada para el proyecto. |

#### 2. Evidencia No Volátil (Adquisición de Disco)

| Paso | Descripción Detallada |
| :--- | :--- |
| **E. Preparación del Disco** | Se convierte la **OVA** de la máquina comprometida a formato **RAW** mediante **QEMU Imager** en el entorno de laboratorio. |
| **F. Adquisición Forense** | [cite_start]En la máquina forense, se monta la imagen RAW y se utiliza **FTK Imager** para crear una copia forense completa (*bit-by-bit*) del disco[cite: 134], asegurando que el *hash* del dispositivo original y el de la imagen coincidan. |

***

### Justificación de Omisión

| Aspecto | Detalle |
| :--- | :--- |
| **Omisión** | En el escenario simulado, **no se extraen físicamente los ficheros** del sistema de la víctima, ni se toman fotografías del estado de la máquina (*fotos de pantalla, conexiones*). |
| **Razón** | Este es un entorno simulado (**Virtual Machine**), donde la adquisición se basa en el acceso remoto y la imagen de la OVA. |
| **Caso Real** | En un incidente real, los pasos omitidos son críticos. Se debe **acordonar y fotografiar la escena**, documentando **pantallas activas**, **conexiones de red** y el **estado físico del equipo** antes de su desconexión. Además, la evidencia volátil se copiaría a un **dispositivo de solo lectura** (ej. USB Write Blocker) para su transporte. |

***

### Descripción de la Evidencia Recolectada

| Evidencia | Tipo de Evidencia | Características Relevantes | Hash SHA256 |
| :--- | :--- | :--- | :--- |
| **EV\_RAM\_raw...** | Memoria Volátil | Contiene el estado del sistema: procesos en ejecución, conexiones de red activas, *sockets* y *strings* sensibles. [cite_start]Formato **RAW/ELF**[cite: 132]. | [cite_start]`1CD9177D101AAF89FFE49014BA929B95CC696D5FFE42D2AB476854F3DA87AE4E` [cite: 132] |
| **Archivos Triage** | Triage *Live* | [cite_start]Archivos de texto (`.txt`) con la salida de comandos como `netstat`, `tasklist`, `ipconfig`, etc. Ficheros que documentan el estado instantáneo del OS[cite: 128, 129, 130]. | *Ej. [cite_start]`EV_arp.txt`: `3BEEDE0D43BC9845B5AF49E489167B2F5E533E55ABAE30224730739B1EFB3D32` [cite: 128]* |
| **EV\_DISC\_raw...** | Imagen de Disco | Copia física *bit-a-bit* del disco duro de la víctima. Contiene el sistema de archivos completo, registros de eventos, *logs* y *artifacts*. [cite_start]Formato **RAW**[cite: 134]. | [cite_start]`E3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855` [cite: 134] |

***

### Cadena de Custodia (Inicio)

| Evidencia | Cuándo | Dónde | Quién | Acción (Descubrimiento/Colección/Custodia) | Hash (Ejemplo) |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **Incidente** | 2025-11-17, 09:00 CET | Dept. de IT (IP X.X.X.X) | Analista Forense 1 | Notificación y aseguramiento de la escena | N/A |
| **EV\_RAM\_raw...** | 2025-11-17, 09:30 CET | Máquina Comprometida | Analista Forense 1 | Recolección (WinPMEM) | [cite_start]`1CD9177D101AAF89FFE49014BA929B95CC696D5FFE42D2AB476854F3DA87AE4E` [cite: 132] |
| **Triage Live** | 2025-11-17, 09:45 CET | Máquina Comprometida | Analista Forense 1 | Recolección (Scripts de Triage) | *Ej. [cite_start]`EV_netstat_ano.txt`: `C54E9276C7244F0F3D900AE9815D5A96B46403DB5731E732F5208F8404D46630` [cite: 129]* |
| **Custodia** | 2025-11-17, 10:00 CET | Servidor Forense | Analista Forense 2 | Recepción y almacenamiento seguro | N/A |

### Almacenamiento de la Evidencia

* **Métodos:** Las evidencias se almacenan en un **Servidor Forense dedicado** con control de acceso estricto. La imagen de disco (`EV_DISC`) se cifra en reposo. Se ha utilizado la **carpeta compartida** de la red aislada como medio de transferencia inicial de los datos volátiles.
* **Ubicación:** Servidor de Almacenamiento Forense, Ruta: `/Proyecto/Caso_2025-11-17_IT_MACHINE/`.

