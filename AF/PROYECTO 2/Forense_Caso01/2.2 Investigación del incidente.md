<h1 align="center">Proyecto 2.2 - Incident Investigation</h1>

![imagen portada análisis forense informático](https://github.com/sgonnor2803/25-26-Ciberseguridad-SGN/blob/master/AFI/images/bannerPortada.png)

***Fecha**: 11 de noviembre de 2025 <br><br> **Autores**: Sergio González, Iván Paúl, Javier Calvillo y Manuel Pérez*

---

## Índice

1. [***¿Qué CVE fue explotado?***](https://github.com/IES-Rafael-Alberti/25-26-Ciberseguridad-Grupo-5/blob/main/AFI/Proyecto2-2.md#1-qu%C3%A9-cve-fue-explotado)
2. [***¿Cuál es el nombre del proceso exacto tras el compromiso de la máquina?***](https://github.com/IES-Rafael-Alberti/25-26-Ciberseguridad-Grupo-5/blob/main/AFI/Proyecto2-2.md#2-cu%C3%A1l-es-el-nombre-del-proceso-exacto-tras-el-compromiso-de-la-m%C3%A1quina)
3. [***¿Qué herramienta de hacking se utilizó una vez comprometida la máquina?***](https://github.com/IES-Rafael-Alberti/25-26-Ciberseguridad-Grupo-5/blob/main/AFI/Proyecto2-2.md#3-qu%C3%A9-herramienta-de-hacking-se-utiliz%C3%B3-una-vez-comprometida-la-m%C3%A1quina)
4. [***Conclusión***](https://github.com/IES-Rafael-Alberti/25-26-Ciberseguridad-Grupo-5/blob/main/AFI/Proyecto2-2.md#4-conclusi%C3%B3n)

---
## 1. ***¿Qué CVE fue explotado?***

Durante la revisión del sistema identificamos que en la máquina comprometida se estaba ejecutando ***Easy File Sharing Web Server 7.2***, un software con vulnerabilidades conocidas. En el Escritorio encontramos un script llamado ***crea_user.py***, que contenía un exploit contra este servicio. El código realizaba una petición POST al recurso ***/sendemail.ghp*** con un payload especialmente diseñado para provocar un desbordamiento de búfer y ejecutar código arbitrario.

Al comparar este comportamiento con las vulnerabilidades documentadas, confirmamos que coincide exactamente con el fallo descrito en:

### ***CVE-2025-34096 – Buffer Overflow en Easy File Sharing Web Server 7.2***

Esta vulnerabilidad permite la ejecución remota de código al enviar un POST malformado al endpoint ***/sendemail.ghp***, lo mismo que hace el exploit encontrado en el sistema.

Por ello, concluimos que la máquina fue comprometida a través del ***CVE-2025-34096***.

---
## 2. ***¿Cuál es el nombre del proceso exacto tras el compromiso de la máquina?***

Al revisar el archivo ***tasklist.txt***, vimos que había un proceso que no debería estar en un Windows 7 normal. El ejecutable se llama:

### ***KzcmVNSNkYkueQf.exe***

### ***PID: 2640***

Este nombre no corresponde a ningún programa del sistema ni a software conocido. De hecho, es típico de un archivo generado por malware (nombre aleatorio y sin firma). Además, aparece ejecutándose en la sesión del usuario, lo que indica que se lanzó después de que la máquina fuera explotada.

Este proceso encaja con el exploit encontrado en el fichero ***crea_user.py***, ya que ese tipo de ataques suelen dejar un payload funcionando una vez que consiguen acceso.

Por tanto, el proceso que confirma la ejecución del malware tras el compromiso es ***KzcmVNSNkYkueQf.exe***.

---
## 3. ***¿Qué herramienta de hacking se utilizó una vez comprometida la máquina?***

Durante el análisis encontramos en el escritorio de la máquina un archivo llamado crea_user.py. Al revisar su contenido, se ve claramente que se trata de un exploit en Python usado para sacar provecho de una vulnerabilidad en:

### ***Easy File Sharing Web Server 7.2***

El propio script incluye referencias como:

- "Exploit Title: Easy File Sharing Web Server 7.2 - 'POST' Buffer Overflow"
- "Created : Ihacklabs Limited"
- Uso de shellcode generado con msfvenom
- Comunicación a través de un socket contra el puerto 8089
- Creación automática del usuario ihacklabs

Todo esto indica que la herramienta utilizada fue:

### ***Metasploit Framework, usando msfvenom + exploit en Python.***

El atacante preparó un payload con msfvenom, lo insertó dentro del exploit en Python y lo ejecutó para explotar el servidor vulnerable. Una vez lanzado, el exploit crea un usuario nuevo en el sistema, lo que confirma que se usó como herramienta de post-explotación.

---
## 4. ***Conclusión***

Después de analizar la máquina comprometida, pudimos confirmar que el ataque se produjo aprovechando una vulnerabilidad del programa ***Easy File Sharing Web Server***. En el equipo encontramos un archivo en el Escritorio que contenía el exploit utilizado y, al compararlo con vulnerabilidades conocidas, vimos que coincide exactamente con el fallo ***CVE-2025-34096***.

También descubrimos que, tras explotarse la máquina, se puso en marcha un proceso extraño con un nombre aleatorio, lo que indica claramente que se ejecutó algún tipo de malware dentro del sistema. Este proceso no forma parte de Windows, así que demuestra que el atacante consiguió hacer que su propio código se ejecutara.

Además, revisando el contenido del exploit, comprobamos que se había usado una herramienta típica de hacking, relacionada con Metasploit, para generar el payload y lanzar el ataque. Incluso se creó un usuario nuevo en el sistema, lo que confirma que el atacante obtuvo control.

En resumen, la máquina fue vulnerada mediante un exploit conocido, se ejecutó código malicioso y se utilizaron herramientas externas para tomar acceso. Todo esto demuestra cómo un fallo sin parchear puede permitir que un atacante llegue a controlar por completo el equipo.
